---
file: /home/pedro/Documents/chatgpt_export/Markdown/Braille Graphics CFFI Library.md
heading_stack: <root> -> b0cd4ccf-b58a-4555-9f13-6b1a31814d25 -> System -> 5a574436-e9d1-4b97-a272-d099a8dccb99 -> System -> aaa20d14-8506-4527-a842-e8b226e754d5 -> User -> 52f2c2a1-f4d8-4c75-a363-e17d0de117dc -> Assistant -> aaa2146d-e69a-4754-a17c-ac579be36bda -> User -> 9fb3444e-a1db-43ec-8cb7-ff0bebf818c7 -> Assistant -> Braille in Unicode -> Bitwise Operations and Braille -> Coordinate Translation -> Algorithmic Considerations -> Next Steps -> aaa2ab0e-08f2-46a3-9747-0e3045469684 -> User -> 255d721d-d5a5-402f-a80e-80b836da960f -> Assistant -> Braille in Unicode -> Coordinate Translation -> Bitwise Operations for Braille Characters -> Data Structure for 2D Grid -> 1179ac9c-0f99-43d0-8a7f-7145c316f4ce -> Assistant -> Braille Character Encoding -> Coordinate Translation -> Data Structure for 2D Grid -> Algorithms -> Performance -> Misc -> aaa2701a-6df8-4c32-aec5-fc99a9438746 -> User -> 3fc4a23e-7f87-4bf6-929d-3a6e379d9b4a -> Assistant -> aaa26e8e-f819-4c4e-8b18-c69eae57abbd -> User -> cb3f33c3-6f4e-4370-bf1a-e3ebe9ac93ec -> Assistant -> Algorithm Drafts -> 1. Coordinate Translation -> 2. Bit Manipulation for Braille Characters -> 3. Data Structure for 2D Grid -> 4. Batch Updates and Line Drawing -> 5. Performance Optimizations -> aaa2a4c4-d9b1-47c2-8858-22f1e7fb135d -> User -> 940d39ef-c0aa-4a3a-b531-7960141acc22 -> Assistant -> aaa248b3-2940-4e7e-b131-1f1b5f3ed9c3 -> User -> 279ebfb8-5650-4dfc-92e6-013ec8a95997 -> Assistant -> 80f28b8e-b9d3-4bcd-b109-c79fa3ec3f2e -> Tool -> 266be4a5-c1b4-465f-817e-1cd8dd7732b9 -> Assistant -> aaa2f1d2-8a73-4832-bf52-76d909b26834 -> User -> ad3956c4-5ac8-4f1d-8c5d-8280f7b794b8 -> Assistant -> 600dca09-a263-4bcf-9dde-42c5c51739cb -> Assistant -> 68a7cc71-b480-4a01-b44b-5cb5c072b4b2 -> Tool -> 8c23eec6-3949-4a51-926d-883fe6adbf05 -> Assistant -> aaa27380-af84-40b8-8b8a-013633c8fd4d -> User -> a5dd7886-43b5-4239-b32e-c3391caca9aa -> Assistant -> aaa2d61b-be2f-42f9-a89c-6bc77c55a21c -> User -> a95e5d9d-8f1a-4e01-aa9d-aeb72bf96868 -> Assistant -> ce79312b-e8a9-470b-b949-cda449ae676c -> Tool -> 83e75b55-cdb4-4c06-8fb1-18485f948e4d -> Assistant -> aaa25a3c-62b8-4abe-8477-6fe7f5a8fda5 -> User -> 9ac08725-1b5c-4755-851d-d1796dccbf7e -> Assistant -> e6d14f99-cfbb-40e8-ae3e-956be63f4603 -> Tool -> 5705d487-c3e8-4228-b40e-06a096eff65d -> Assistant -> aaa2f20e-acec-4be9-a2b4-81fb8ac3b7ca -> User -> e8a32c1e-4bf4-41ee-b2bc-7ae16d4278fb -> Assistant -> 62d23bf6-d464-4f23-ac35-8466be6af3a0 -> Tool -> 1733d486-2532-4953-a9ab-5bcabce7a790 -> Assistant -> aaa2be49-10a7-4262-95a3-910466c21188 -> User -> 16cd5ded-1ed9-41e2-993e-3a6403704f51 -> Assistant -> Data Structure -> Coordinate Mapping -> Bit Manipulation -> Canvas Rendering -> Error Handling -> C-Python Interoperability -> Optimizations -> aaa2f39e-a77c-495c-9734-9bf1c676c4d2 -> User -> c84ca179-7c2b-4874-bcd2-730f882af3eb -> Assistant -> 5a38a843-4f37-45b7-9a25-b28e148ae862 -> Tool -> c3154af8-37a3-476b-bc7f-6d7fa1567c07 -> Assistant -> aaa2372d-e931-4c79-903c-e0219deaa466 -> User -> 9ef76b3a-3122-49c4-a357-6f4011f3c091 -> Assistant -> aaa25d3b-c50a-47cb-ace3-1be777e0538e -> User -> 8a7f5919-108b-4f80-85da-aa821ac43772 -> Assistant -> c23d269a-78c8-462f-a25c-70bf5527db43 -> Tool -> 43bedf60-976a-47de-882b-f83aacc088db -> Assistant -> aaa22553-171e-406b-8048-0790ec7cf515 -> User -> 7f5a2269-e4fd-4781-8ed2-e1faf11b39aa -> Assistant -> b3ad45c2-d094-4600-90a9-d362cf8f483a -> Tool -> 78e8d354-5cee-457c-8677-7cb6eb2b854f -> Assistant -> aaa21b12-6f84-47b3-a5bc-bda5ca4b4502 -> User -> 6b302e10-5228-408d-9ec2-94be39d3e81c -> Assistant -> 67fc891c-62e0-47b8-952e-c13465d1a166 -> Tool -> 5fca9189-3b62-4495-9279-783113cf705f -> Assistant -> aaa2ccc7-6254-44f7-8217-f75cb8bc9798 -> User -> 9ef43be0-b8cb-4655-b60e-6bfeadb76596 -> Assistant -> 633697ec-2cc7-4a64-b163-f1828ea5b8fa -> Tool -> d6e07cae-21cd-4edd-83f4-cee5ff21a45f -> Assistant -> aaa22f46-0879-44a7-bcc6-5152515ec621 -> User -> 2058584e-097f-49bd-b177-ebc265fa0f7f -> Assistant -> bd94f34d-e598-4bde-9b59-7a0c80605c11 -> Tool -> ef0cabd6-1e4d-43de-8237-c599d7051fc0 -> Assistant -> aaa23cdd-5f92-4098-80a0-fb67a253704b -> User -> a802b49f-7525-48b4-ba80-0a0ed0193e17 -> Assistant -> 802c1bd3-eb33-46eb-9176-6b2c715a3833 -> Tool -> 3ae01b74-8a16-4190-89a8-c18f2baaa958 -> Assistant -> 9d6a026d-e2b0-40c2-8560-307f7f26bf9b -> Tool -> 7064a5b5-f3b2-4a94-a003-155c03acdb5c -> Assistant -> aaa244e4-abb6-428b-b415-5905cd1c39b3 -> User -> bf51c90c-1370-4891-be28-dafda5c32dd5 -> Assistant -> 1a0de50a-ca91-4892-a99d-6c801ce814f3 -> Tool
---
# Tool

```python
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
File ~/.local/lib/python3.8/site-packages/cffi/api.py:183, in FFI._typeof(self, cdecl, consider_function_as_funcptr)
    182 try:
--> 183     result = self._parsed_types[cdecl]
    184 except KeyError:

KeyError: 'Coordinate[]'

During handling of the above exception, another exception occurred:

ParseError                                Traceback (most recent call last)
File ~/.local/lib/python3.8/site-packages/cffi/cparser.py:336, in Parser._parse(self, csource)
    335 try:
--> 336     ast = _get_parser().parse(fullcsource)
    337 except pycparser.c_parser.ParseError as e:

File ~/.local/lib/python3.8/site-packages/pycparser/c_parser.py:147, in CParser.parse(self, text, filename, debug)
    146 self._last_yielded_token = None
--> 147 return self.cparser.parse(
    148         input=text,
    149         lexer=self.clex,
    150         debug=debug)

File ~/.local/lib/python3.8/site-packages/pycparser/ply/yacc.py:331, in LRParser.parse(self, input, lexer, debug, tracking, tokenfunc)
    330 else:
--> 331     return self.parseopt_notrack(input, lexer, debug, tracking, tokenfunc)

File ~/.local/lib/python3.8/site-packages/pycparser/ply/yacc.py:1199, in LRParser.parseopt_notrack(self, input, lexer, debug, tracking, tokenfunc)
   1198 self.state = state
-> 1199 tok = call_errorfunc(self.errorfunc, errtoken, self)
   1200 if self.errorok:
   1201     # User must have done some kind of panic
   1202     # mode recovery on their own.  The
   1203     # returned token is the next lookahead

File ~/.local/lib/python3.8/site-packages/pycparser/ply/yacc.py:193, in call_errorfunc(errorfunc, token, parser)
    192 _restart = parser.restart
--> 193 r = errorfunc(token)
    194 try:

File ~/.local/lib/python3.8/site-packages/pycparser/c_parser.py:1931, in CParser.p_error(self, p)
   1930 if p:
-> 1931     self._parse_error(
   1932         'before: %s' % p.value,
   1933         self._coord(lineno=p.lineno,
   1934                     column=self.clex.find_tok_column(p)))
   1935 else:

File ~/.local/lib/python3.8/site-packages/pycparser/plyparser.py:67, in PLYParser._parse_error(self, msg, coord)
     66 def _parse_error(self, msg, coord):
---> 67     raise ParseError("%s: %s" % (coord, msg))

ParseError: <cdef source string>:2:11: before: [

During handling of the above exception, another exception occurred:

CDefError                                 Traceback (most recent call last)
Cell In[14], line 23
     20 set_dot(canvas, 3, 5, width)
     22 # Set a batch of dots on the canvas
---> 23 coords = ffi.new("Coordinate[]", [(0, 0), (2, 6)])
     24 set_dots_batch(canvas, coords, 2, width)
     26 # Render the canvas (this will print the braille characters directly to the terminal)

File ~/.local/lib/python3.8/site-packages/cffi/api.py:266, in FFI.new(self, cdecl, init)
    243 """Allocate an instance according to the specified C type and
    244 return a pointer to it.  The specified C type must be either a
    245 pointer or an array: ``new('X *')`` allocates an X and returns
   (...)
    263 else, e.g. into another structure.
    264 """
    265 if isinstance(cdecl, basestring):
--> 266     cdecl = self._typeof(cdecl)
    267 return self._backend.newp(cdecl, init)

File ~/.local/lib/python3.8/site-packages/cffi/api.py:186, in FFI._typeof(self, cdecl, consider_function_as_funcptr)
    184 except KeyError:
    185     with self._lock:
--> 186         result = self._typeof_locked(cdecl)
    187 #
    188 btype, really_a_function_type = result

File ~/.local/lib/python3.8/site-packages/cffi/api.py:171, in FFI._typeof_locked(self, cdecl)
    169     cdecl = cdecl.encode('ascii')
    170 #
--> 171 type = self._parser.parse_type(cdecl)
    172 really_a_function_type = type.is_raw_function
    173 if really_a_function_type:

File ~/.local/lib/python3.8/site-packages/cffi/cparser.py:552, in Parser.parse_type(self, cdecl)
    551 def parse_type(self, cdecl):
--> 552     return self.parse_type_and_quals(cdecl)[0]

File ~/.local/lib/python3.8/site-packages/cffi/cparser.py:555, in Parser.parse_type_and_quals(self, cdecl)
    554 def parse_type_and_quals(self, cdecl):
--> 555     ast, macros = self._parse('void __dummy(\n%s\n);' % cdecl)[:2]
    556     assert not macros
    557     exprnode = ast.ext[-1].type.args.params[0]

File ~/.local/lib/python3.8/site-packages/cffi/cparser.py:338, in Parser._parse(self, csource)
    336     ast = _get_parser().parse(fullcsource)
    337 except pycparser.c_parser.ParseError as e:
--> 338     self.convert_pycparser_error(e, csource)
    339 finally:
    340     if lock is not None:

File ~/.local/lib/python3.8/site-packages/cffi/cparser.py:367, in Parser.convert_pycparser_error(self, e, csource)
    365 else:
    366     msg = 'parse error\n%s' % (msg,)
--> 367 raise CDefError(msg)

CDefError: cannot parse "Coordinate[]"
<cdef source string>:2:11: before: [

```

[child ⬇️](#0b67a8a9-ba76-439b-b354-7858c140c478)

---

(main branch ⎇)
###### 0b67a8a9-ba76-439b-b354-7858c140c478
[parent ⬆️](#1a0de50a-ca91-4892-a99d-6c801ce814f3)
